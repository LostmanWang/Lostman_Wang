---
title: Python数据类型-基础数据类型-映射类型 --- dict
description: 映射类型 --- dict
publishDate: 2025-08-05T19:48
---
* 字典是以关键字（键）为索引，关键字（键）可以是任意不可变类型
* 字典由键和对应值成对组成，字典中所有的键值对放在 { } 中间，每一对键值之间用逗号分开

## 一、构造方法

### 1、字面量直接构造

```python
d1 = {}                    # 空 dict
d2 = {'a': 1, 'b': 2}      # 键值对字面量
d3 = {                     # 多行可读性高
    'name': 'Alice',
    'age': 30
}
```

* 键必须是 **可哈希** 对象；值任意。
* 重复键以 **最后一次** 为准。

### 2、内置构造函数 `dict(**kwargs)` / `dict(mapping)` / `dict(iterable)`

| 调用形式                       | 说明                      |
| -------------------------- | ----------------------- |
| `dict()`                   | 空字典                     |
| `dict(a=1, b=2)`           | 关键字参数 → `{'a':1,'b':2}` |
| `dict([('a',1), ('b',2)])` | 二元组/列表迭代                |
| `dict(zip(keys, values))`  | 并行序列组合                  |
| `dict({'a':1}, b=2)`       | 先映射再关键字参数               |

支持 **任意可迭代**，只要元素是 **长度为 2 的子序列**。

### 3、字典推导式（Dict Comprehension）

```python
squares = {x: x**2 for x in range(5)}          # {0:0,1:1,2:4,3:9,4:16}
odd_only = {k: v for k, v in some_dict.items() if v % 2}
```

* 语法：`{键表达式: 值表达式 for 变量 in 可迭代 [if 条件]}`。
* 支持嵌套循环、条件过滤。

### 4、映射解包（PEP 448）

```python
defaults = {'host': '127.0.0.1', 'port': 3306}
user = {'host': '192.168.1.10'}
merged = {**defaults, **user}   # 后写覆盖前写
```

### 5、类方法 `fromkeys`

```python
keys = ['a', 'b', 'c']
d = dict.fromkeys(keys, 0)   # {'a':0, 'b':0, 'c':0}
```

* 第一个参数：可迭代键序列；第二个参数：默认值（浅拷贝）。

### 6、生成器表达式转 dict

```python
d = dict((k, f(k)) for k in iterable)
```

* 等价于推导式，但可读性略低。

### 7、与第三方对象互转

| 来源                    | 示例                      | 备注            |
| --------------------- | ----------------------- | ------------- |
| `collections.Counter` | `dict(Counter('aab'))`  | 频率 → dict     |
| `json.loads`          | `json.loads('{"x":1}')` | JSON → dict   |
| `csv.DictReader`      | `dict(DictReader(f))`   | CSV → dict    |
| `pandas.Series`       | `s.to_dict()`           | Pandas → dict |

### 8、空值快捷构造

```python
# 常用工厂
empty = dict()
empty2 = {}
```

### 9、性能与陷阱

* 键重复：字面量 **后值覆盖前值**。
* 不可哈希键：会抛 `TypeError: unhashable type`。
* 顺序：Python 3.7+ **保留插入顺序**，但语义上仍视为无序。

## 二、常见函数

### 1、len

* 获取字典中键值对的数量

```python
# len
var = {'a': 'A', 'b': 'B', 'c': 'C'}
print(len(var))


# 输出结果
3
```

### 2、list

* 返回包含该字典中所有键的列表

```python
# list
book = {
    'title': 'Python 入门基础',
    'author': '张三',
    'press': '机械工业出版社'
}
print(list(book))


# 输出结果
['title', 'author', 'press']
```

* 这个返回结果是无序的
* tuple() 一样也可以这样哦，返回的是键组成的元组

### 3、sorted

* 返回包含该字典中所有键的有序列表

```python
# sorted
book = {
    'title': 'Python 入门基础',
    'author': '张三',
    'press': '机械工业出版社'
}
print(sorted(book))


# 输出结果
['author', 'press', 'title']
```

## 三、常见方法

### 1、dict.get(key, default=None)

##### 1.1、作用：

* 在 **不触发 KeyError 的前提下**，按键获取字典中的值；若键不存在，则返回自定义默认值。常用于 **安全取值、配置回退、计数器初始化** 等场景。

##### 1.2、参数：

* **key**（必需）：需要查询的键，任意可哈希对象。
* **default**（可选，默认为 `None`）：键不存在时返回的默认值，可为任意类型（数字、列表、对象、lambda 等）。

##### 1.3、返回值：

* 键存在 → 返回该键对应的 **值对象**。
* 键不存在 → 返回 **default** 的值（默认 None）。
* **不会修改原字典**，也不会抛出 KeyError。

##### 1.4、与 \[] 和 setdefault 对比

| 形式                     | 键不存在时行为         | 是否插入新键 |
| ---------------------- | --------------- | ------ |
| `d[key]`               | 抛出 `KeyError`   | ❌      |
| `d.get(key, def)`      | 返回 `def`        | ❌      |
| `d.setdefault(k, def)` | 返回 `def` 并插入键值对 | ✅      |

```python
# 基本用法
cfg = {'host': '127.0.0.1', 'port': 3306}
print(cfg.get('host'))          # '127.0.0.1'
print(cfg.get('timeout'))       # None

# 提供默认值
timeout = cfg.get('timeout', 30)   # 30
retry   = cfg.get('retry', 3)      # 3

# 默认值可为可变对象
log = cfg.setdefault('log', [])    # 若键不存在会写入 dict
# 与 get 区别：setdefault 会插入键值对
```

### 2、dict.clear() -> None

##### 2.1、作用：

* **就地（in-place）** 删除字典中 **所有键值对**，使之变为空字典 `{}`，但 **不销毁字典对象本身**（内存地址不变）。

##### 2.2、参数：

* 无参数，调用时括号内 **不得传入任何值**。

##### 2.3、返回值：

* 始终返回 **None**；字典对象本身被清空。

##### 2.4、与重新赋值的区别

| 方式          | 对象 id 是否改变 | 哈希表内存是否释放 | 适用场景     |
| ----------- | ---------- | --------- | -------- |
| `d.clear()` | ❌ 不变       | ❌ 保留      | 需要保持同一引用 |
| `d = {}`    | ✅ 新建       | ✅ 回收旧表    | 不关心旧对象   |

```python
>>> d = {'a': 1, 'b': 2, 'c': 3}
>>> old_id = id(d)
>>> d.clear()
>>> d
{}
>>> id(d) == old_id   # 对象身份不变
True
```

### 3、dict.pop(key, *\[, default]) -> value

##### 3.1、作用：

* **按键删除** 并 **返回** 字典中对应的值；如果键不存在，且提供了 `default`，则返回 `default`；否则抛出 `KeyError`

:::note
与列表 `pop()` 不同，字典 `pop()` 只能按 **键** 删除，不能按索引
:::

##### 3.2、参数：

* **key**（必需）：要删除的键，任意可哈希对象。
* **default**（可选关键字参数）：键不存在时返回的默认值：若省略 `default`，键不存在则抛 `KeyError: key`。

##### 3.3、返回值：

* 键存在 → 返回该键对应的 **值对象**。
* 键不存在且提供 default → 返回 default 的值。
* 键不存在且未提供 default → 抛出 KeyError。

#### 3.4、与 `del` 语句对比

| 形式                | 键不存在时行为       | 是否返回值 |
| ----------------- | ------------- | ----- |
| `del d[key]`      | 抛出 `KeyError` | ❌     |
| `d.pop(key)`      | 同上            | ✅     |
| `d.pop(key, def)` | 返回 `def`      | ✅     |

```python
# 基本用法
d = {'a': 1, 'b': 2, 'c': 3}
v = d.pop('b')        # v == 2, d == {'a':1,'c':3}

# 提供默认值
v = d.pop('x', 0)     # v == 0, d 不变

# 键不存在且无默认值
# d.pop('x')          # KeyError: 'x'
```

### 4、dict.update(\[other]) -> None

##### 4.1、作用：

* **原地** 把另一个映射或可迭代键值对合并到当前字典；常用于一次性批量更新配置、合并字典、或从迭代器加载数据。
* 已存在的键会被 **覆盖**（后写优先）；
* 不存在的键会被 **新增**。

##### 4.2、参数：

* `other`（位置或关键字参数，可选）
* 支持 **三种形态**：

| 形态         | 说明                | 示例                               |
| ---------- | ----------------- | -------------------------------- |
| **映射对象**   | 任意实现 `keys()` 的对象 | `dict`, `UserDict`, `os.environ` |
| **可迭代键值对** | 元素长度为 2 的可迭代      | `[('a',1), ('b',2)]`             |
| **关键字参数**  | 直接写在括号里           | `update(a=1, b=2)`               |

##### 4.3、返回值：

* 始终返回 **None**；原字典本身被修改。

#### 4.4、与 `{**d1, **d2}` 的区别

| 形式              | 是否原地 | 是否创建新对象 |
| --------------- | ---- | ------- |
| `d1.update(d2)` | ✅ 原地 | ❌       |
| `{**d1, **d2}`  | ❌ 新建 | ✅       |

```python
# 1. 映射对象
base = {'host': '127.0.0.1', 'port': 3306}
override = {'port': 5432, 'ssl': True}
base.update(override)
# base -> {'host':'127.0.0.1','port':5432,'ssl':True}

# 2. 可迭代键值对
base.update([('timeout', 30), ('retry', 3)])

# 3. 关键字参数
base.update(user='root', pwd='secret')

# 4. 空调用（无操作）
base.update()
```
