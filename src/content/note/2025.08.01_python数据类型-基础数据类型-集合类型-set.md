---
title: Python数据类型-基础数据类型-集合类型 --- set
description: set
publishDate: 2025-08-01T11:09
---
## 一、构造方法

### 1、字面量直接构造

```python
s1 = {1, 2, 3}          # 花括号 + 逗号分隔；空集合不能用 {}，那是 dict
```

| 特点     | 说明                           |
| ------ | ---------------------------- |
| 语法    | 最简洁，但 **不能用于空集**（`{}` 是空字典）。 |
| 元素自动去重 | `{1, 1, 2}` → `{1, 2}`       |

### 2、内置构造函数 set(iterable=\[])

```python
s2 = set()                 # 空集合
s3 = set([1, 2, 3, 2])     # 任意可迭代对象 → 去重
s4 = set('hello')          # {'h', 'e', 'l', 'o'}
s5 = set(range(5))         # {0, 1, 2, 3, 4}
```

| 形参       | 默认值         | 说明                           |
| -------- | ----------- | ---------------------------- |
| iterable | `[]`        | 任何遵循迭代协议的对象（列表、元组、字符串、生成器等）。 |
| 返回值      | 新的 `set` 实例 | O(n) 复杂度，n = 去重后元素个数。        |

### 3、集合推导式（Set Comprehension）

```python
s6 = {x**2 for x in range(5) if x % 2 == 0}   # {0, 4, 16}
```

* 语法与列表/字典推导式一致，自带去重。
* 执行过程：先构造临时列表 → 再转成集合（复杂度 O(n)）。

### 4、从映射对象构造（键集合）

```python
d = {'a': 1, 'b': 2}
s7 = set(d)         # {'a', 'b'}  —— 取字典的 key 视图
```

* 等价于 `set(d.keys())`，同样 O(n)。

### 5、利用 frozenset 再转 set

```python
fs = frozenset([1, 2, 3])
s8 = set(fs)        # 把不可变集合变成可变集合
```

* 当已有 `frozenset` 且需要可变性时，可节省一次去重。

### 6、性能与常见误区

#### 6.1、空集合

* 错误：empty = {} → 这是空字典！
* 正确：empty = set() 或 set().

#### 6.2、元素必须可哈希

* 不可哈希对象（如列表、字典本身）无法加入集合：
* set(\[[1, 2]]) → TypeError: unhashable type: 'list'.

#### 6.3、大列表去重最快方式

* unique = list(set(big_list))
* 时间复杂度：O(n)，空间额外 O(n)。

#### 6.4、构造器 vs 字面量

* 字面量 {1, 2, 3} 在字节码层面直接生成 BUILD_SET，
* 比 set(\[1, 2, 3]) 少一次列表临时对象，略快。

## 二、
