---
title: Python数据类型-基础数据类型-集合类型 --- set
description: set
publishDate: 2025-08-01T11:09
---
* set 对象是由具有唯一性的hashable 对象所组成的无序多项集。常见的用途包括成员检测、从序列中去除重复项以及数学中的集合类计算，例如交集、并集、差集与对称差集等等。
* 与其他多项集一样，集合也支持 x in set, len(set) 和 for x in set。作为一种无序的多项集，集合并不记录元素位置或插入顺序。相应地，集合不支持索引、切片或其他序列类的操作。

## 一、构造方法

### 1、字面量直接构造

```python
s1 = {1, 2, 3}          # 花括号 + 逗号分隔；空集合不能用 {}，那是 dict
```

| 特点     | 说明                           |
| ------ | ---------------------------- |
| 语法     | 最简洁，但 **不能用于空集**（`{}` 是空字典）。 |
| 元素自动去重 | `{1, 1, 2}` → `{1, 2}`       |

### 2、内置构造函数 set(iterable=\[])

```python
s2 = set()                 # 空集合
s3 = set([1, 2, 3, 2])     # 任意可迭代对象 → 去重
s4 = set('hello')          # {'h', 'e', 'l', 'o'}
s5 = set(range(5))         # {0, 1, 2, 3, 4}
```

| 形参       | 默认值         | 说明                           |
| -------- | ----------- | ---------------------------- |
| iterable | `[]`        | 任何遵循迭代协议的对象（列表、元组、字符串、生成器等）。 |
| 返回值      | 新的 `set` 实例 | O(n) 复杂度，n = 去重后元素个数。        |

### 3、集合推导式（Set Comprehension）

```python
s6 = {x**2 for x in range(5) if x % 2 == 0}   # {0, 4, 16}
```

* 语法与列表/字典推导式一致，自带去重。
* 执行过程：先构造临时列表 → 再转成集合（复杂度 O(n)）。

### 4、从映射对象构造（键集合）

```python
d = {'a': 1, 'b': 2}
s7 = set(d)         # {'a', 'b'}  —— 取字典的 key 视图
```

* 等价于 `set(d.keys())`，同样 O(n)。

### 5、利用 frozenset 再转 set

```python
fs = frozenset([1, 2, 3])
s8 = set(fs)        # 把不可变集合变成可变集合
```

* 当已有 `frozenset` 且需要可变性时，可节省一次去重。

### 6、性能与常见误区

#### 6.1、空集合

* 错误：empty = {} → 这是空字典！
* 正确：empty = set() 或 set().

#### 6.2、元素必须可哈希

* 不可哈希对象（如列表、字典本身）无法加入集合
* set(\[[1, 2]]) → TypeError: unhashable type: 'list'.

#### 6.3、大列表去重最快方式

* unique = list(set(big_list))
* 时间复杂度：O(n)，空间额外 O(n)。

#### 6.4、构造器 vs 字面量

* 字面量 {1, 2, 3} 在字节码层面直接生成 BUILD_SET，
* 比 set(\[1, 2, 3]) 少一次列表临时对象，略快。

## 二、常见方法

### 1、set.add(elem) -> None

##### 1.1、作用：

* 向集合 原地（in-place） 插入单个元素；若元素已存在则什么也不做，保证集合唯一性。

##### 1.2、参数：

* elem (必需)。
* 任意 **可哈希（hashable）** 对象：int、str、tuple 等；
* 不可哈希对象（list、dict、set）会抛出 `TypeError: unhashable type: 'xxx'`。

##### 1.3、返回值：

* 始终返回 **None**（因为 set 本身被修改）。

```python
s = {1, 2}
s.add(3)          # s == {1, 2, 3}
s.add(2)          # 已存在，无变化
# s.add([4, 5])   # TypeError: unhashable type: 'list'
```

### 2、set.discard(elem) -> None

##### 2.1、作用：

* 从集合 **就地（in-place）** 删除指定元素；如果元素不存在，**静默忽略**（不抛异常），保证集合唯一性不变。

##### 2.2、参数：

* elem（必需）
* 必须是 **可哈希**（hashable） 对象。
* 只要 elem == existing_item 则认为匹配，不要求对象身份一致。

##### 2.3、返回值：

* 始终返回 **None**；集合本身被修改。

### 3、set.remove(elem) -> None

##### 3.1、作用：

* 从集合 **就地（in-place）** 删除 **指定元素**；若元素不存在，抛出 `KeyError`。

##### 3.2、参数：

* elem (必需)。
* 任意 **可哈希** 对象，必须与集合内某个元素 **相等（==）** 才能匹配。
* 元素不存在时，抛出 `KeyError: elem`。

##### 3.3、返回值：

* 始终返回 **None**（集合本身被修改）。

##### 3.4、与相关方法对比

| 方法              | 元素不存在时行为      | 返回值  |
| --------------- | ------------- | ---- |
| `remove(elem)`  | 抛出 `KeyError` | None |
| `discard(elem)` | **静默忽略**      | None |

```python
s = {1, 2, 3}
s.remove(2)          # s == {1, 3}
# s.remove(4)        # KeyError: 4
```

### 4、set.pop() -> element

##### 4.1、作用：

* **就地** 从集合中 **移除并返回任意一个元素**。
* 由于 set 无序，具体返回哪一个元素由内部哈希表实现决定，但保证 **O(1)** 时间复杂度。

##### 4.2、参数：

* 无参数。调用时括号内 **不允许传值**。

##### 4.3、返回值：

* 返回被移除的那个元素；若集合 **为空**，抛出 `KeyError: 'pop from an empty set'`。

##### 4.4、与列表 pop() 区别

| 方法               | 是否可指定索引 | 是否有序 | 空时行为         |
| ---------------- | ------- | ---- | ------------ |
| `list.pop(i=-1)` | ✅ 可指定   | ✅ 有序 | `IndexError` |
| `set.pop()`      | ❌ 不可指定  | ❌ 无序 | `KeyError`   |

```python
s = {3, 1, 4}
x = s.pop()      # x 可能是 1、3 或 4
print(s)         # 剩余 2 个元素
s.pop()          # 再弹一个
s.pop()          # 再弹一个
# s.pop()        # KeyError: 'pop from an empty set'
```

### 5、set.clear() -> None

##### 5.1、作用：

**就地（in-place）** 移除集合中的所有元素，使其变为空集合 `set()`，但 **对象身份不变**（内存地址不变）。

##### 5.2、参数：

无参数，调用时括号内 **不得传入任何值**。

##### 5.3
